adf(a)
acf(a)
library(urca)
test=ur.df(anchovy, type="none", lags=0)
summary(test)
library(urca)
test=ur.df(anchovy, type="none", lags=0)
a=summary(test)
names(a)
class(a)
a
?adf.test
library(urca)
adf.df(anchovy)
library(urca)
adf.test(anchovy)
adf.test(sardine)
adf.test(diff(sardine))
library(tseries)
kpss.test(anchovy)
kpss.test(sardine)
kpss.test
kpss.test?
?kpss.test
library(tseries)
kpss.test(anchovy, null="Trend")
kpss.test(sardine)
kpss.test(diff(anchovy))
kpss.test(diff(diff(anchovy)))
kpss.test(diff(diff(anchovy)),null="Trend")
library(tseries)
kpss.test(anchovy, null="Trend")
kpss.test(sardine)
library(tseries)
kpss.test(anchovy, null="Trend")
kpss.test(sardine, null="Trend")
library(tseries)
kpss.test(anchovy)
kpss.test(sardine)
library(tseries)
kpss.test(anchovy, null="Trend")
kpss.test(sardine)
load("Data/landings.RData")
landings = subset(landings, Year <= 1989)
library(ggplot2)
ggplot(landings, aes(x=Year, y=metric.tons)) +
geom_line() + facet_wrap(~Species)
landings$t = 1:24
load("Data/landings.RData")
landings = subset(landings, Year <= 1989)
library(ggplot2)
ggplot(landings, aes(x=Year, y=metric.tons)) +
geom_line() + facet_wrap(~Species)
landings$t = 1:24
landings
landings$t = landings$Year-1963
model <- lm(log.metric.tons ~ poly(t,3),data=landings)
load("Data/landings.RData")
landings$log.metric.tons = log(landings$metric.tons)
landings = subset(landings, Year <= 1989)
library(ggplot2)
ggplot(landings, aes(x=Year, y=metric.tons)) +
geom_line() + facet_wrap(~Species)
landings$t = landings$Year-1963
model <- lm(log.metric.tons ~ poly(t,3),data=landings)
model
summary(model)
?lm
landings$t = landings$Year-1963
model <- lm(log.metric.tons ~ poly(t,3),
data=landings, subset=Species=="Anchovy")
summary(model)
landings$t = landings$Year-1963
model <- lm(log.metric.tons ~ poly(t,1),
data=landings, subset=Species=="Anchovy")
model
summary(model)
landings$t
model <- lm(log.metric.tons ~ poly(t,1),
data=landings, subset=Species=="Anchovy" & Year <= 1987)
summary(model)
dat = subset(landings, Species=="Anchovy" & Year <= 1987)
model <- lm(log.metric.tons ~ poly(t,1),
data=dat)
dat
model <- lm(log.metric.tons ~ t,
data=dat)
summary(model)
dat
summary(model)
coef(model)
summary(model)$adj.rsquared
names(summary(model))
coef(model)
summary(model)$adj.r.squared
x <- residuals(model)
Box.test(x, lag = 1, type = "Ljung-Box", fitdf = 1)
x
Box.test(x, lag = 1, type = "Ljung-Box")
Box.test(x, lag = 1, type = "Ljung-Box", fitdf=121)
Box.test(x, lag = 1, type = "Ljung-Box", fitdf=12)
Box.test(x, lag = 1, type = "Ljung-Box", fitdf=0)
dat = subset(landings, Species=="Anchovy" & Year <= 1987)
model <- lm(log.metric.tons ~ t,
data=dat)
x <- resid(model)
Box.test(x, lag = 1, type = "Ljung-Box", fitdf = 1)
?box.text
?Box.test
Box.test(x, lag = 20, type = "Ljung-Box", fitdf = 1)
Box.test(x, lag = 13, type = "Ljung-Box", fitdf = 1)
Box.test(x, lag = 13, type = "Ljung-Box")
Box.test(x, lag = 12, type = "Ljung-Box")
x <- resid(model)
Box.test(x, lag = 12, type = "Ljung-Box")
x <- resid(model)
Box.test(x, lag = 13, type = "Ljung-Box")
dat
coef(model)
summary(model)$adj.r.squared
x <- resid(model)
Box.test(x, lag = 13, type = "Ljung-Box", fitdf=1)
x <- resid(model)
Box.test(x, lag = 12, type = "Ljung-Box")
dat = subset(landings, Species=="Sardine" & Year <= 1987)
model <- lm(log.metric.tons ~ t + I(t^2) + I(t^3) + I(t^4), data=dat)
c(coef(model), summary(model)$adj.r.squared)
x <- resid(model)
Box.test(x, lag = 14, type = "Ljung-Box")
x <- resid(model)
Box.test(x, lag = 14, type = "Ljung-Box",fitdf=5)
dim(dat)
24/5
summary(model)
model <- lm(log.metric.tons ~ poly(t,4), data=dat)
summary(model)
model.matrix(model)
dat = subset(landings, Species=="Sardine" & Year <= 1987)
model <- lm(log.metric.tons ~ t + I(t^2) + I(t^3) + I(t^4), data=dat)
model.matrix(model)
poly(1:24,4)
apply(poly(1:24,4),2,mean)
apply(poly(1:24,4),2,var)
aa=poly(1:24,4)
plot(aa[,1],aa[,2])
plot(aa[,1],aa[,3])
plot(aa[,1],aa[,4])
corr(aa[,1],aa[,4])
cov(aa[,1],aa[,4])
cov(1:24,(1:24)^2)
TT = 1:24
cov(TT, TT^2)
cov(poly(TT,2))
poly(TT,2)
T1 = 1:24; T2=T1^2
cov(T1, T2)
T1 = poly(T1,2)[,1]; T2=poly(T1,2)[,2]
cov(T1, T2)
plot(T2)
plot(T1)
plot(T1^2)
plot(T2)
plot(T2-T1)
plot(T2-T1,T2)
plot(T1^2-T1,T2)
plot(T1^2,T2)
T1^2/T2
T1^2[24]/T2[24]
T2
T2[24
]
(T1^2)[24]/T2[24]
((T1^2)[24]/T2[24])/T2[24]
T1 = 1:24; T2=T1^2
plot(T1,T2)
T1 = poly(T1,2)[,1]; T2=poly(T1,2)[,2]
tt=1:24
plot(tt-mean(tt),T1)
plot((tt-mean(tt))/sqrt(var(tt-mean(tt))),T1)
plot((tt-mean(tt))/(var(tt-mean(tt))),T1)
(tt-mean(tt))/(var(tt-mean(tt)))
T1
ttt=tt/sqrt(var(tt))
ttt-mean(ttt)
ttt=tt/(var(tt))
ttt-mean(ttt)
T1 = 1:24; T2=T1^2
c(mean(T1),mean(T2),var(T1),var(T2),cov(T1, T2))
T1 = poly(T1,2)[,1]; T2=poly(T1,2)[,2]
c(mean(T1),mean(T2),var(T1),var(T2),cov(T1, T2))
T1 = 1:24; T2=T1^2
c(mean(T1),mean(T2),var(T1),var(T2),cov(T1, T2))
T1 = poly(T1,2)[,1]; T2=poly(T1,2)[,2]
c(mean(T1),mean(T2),var(T1),var(T2),cov(T1, T2))
T1 = 1:24; T2=T1^2
c(mean(T1),mean(T2),cov(T1, T2))
T1 = poly(T1,2)[,1]; T2=poly(T1,2)[,2]
c(mean(T1),mean(T2),cov(T1, T2))
dat = subset(landings, Species=="Sardine" & Year <= 1987)
model <- lm(log.metric.tons ~ t + I(t^2) + I(t^3) + I(t^4), data=dat)
x <- resid(model)
Box.test(x, lag = 14, type = "Ljung-Box",fitdf=5)
acf(resid(model))
dir()
tt
plot(tt+tt^2+tt^3+tt^4)
plot(tt-tt^2+tt^3-tt^4)
plot(10-.02*tt+0.03*tt^2-0.002*tt^3+0.00003*tt^4)
plot(10-.02*tt+0.03*tt^2)
plot(10-2*tt+0.03*tt^2)
plot(10-2*tt+3*tt^2)
plot(10-2*tt+3*(tt-10)^2)
par(mfrow=c(1,4))
tt=1:24
plot(tt)
plot((tt-10)^2)
plot(tt^4-4*tt^3-2*tt^2+12*tt-3)
par(mfrow=c(1,4))
tt=1:24
plot(tt)
plot((tt-10)^2)
plot(tt^4-4*tt^3-2*tt^2+12*tt-3)
par(mfrow=c(1,4))
tt=-10:10
plot(tt)
plot((tt-10)^2)
plot(tt^4-4*tt^3-2*tt^2+12*tt-3)
par(mfrow=c(1,4))
tt=-10:10
plot(tt)
plot((tt-10)^2)
plot(tt^4-4*tt^3-2*tt^2+12*tt-3)
```{r poly.plot, echo=FALSE}
par(mfrow=c(1,4))
tt=-10:10
plot(tt)
plot(tt^2)
plot(tt^4-4*tt^3-2*tt^2+12*tt-3)
plot(tt^4+2*tt^3-12*tt^2-2*tt+6)
plot(tt^4+2*tt^3-12*tt^2-2*tt+6,ylim=c(-5,5))
plot(tt^4+2*tt^3-12*tt^2-2*tt+6,ylim=c(-20,20))
plot(tt^4+2*tt^3-12*tt^2-2*tt+6,ylim=c(-200,200))
par(mfrow=c(1,4))
tt=seq(-5,5,.01)
plot(tt)
plot(tt^2)
plot(tt^4+2*tt^3-12*tt^2-2*tt+6,ylim=c(-200,200))
par(mfrow=c(1,4))
tt=seq(-5,5,.01)
plot(tt,type="l")
plot(tt^2,type="l")
plot(tt^3-3*tt^2-tt+3,ylim=c(-100,200),type="l")
plot(tt^4+2*tt^3-12*tt^2-2*tt+6,ylim=c(-100,200),type="l")
par(mfrow=c(1,4))
tt=seq(-5,5,.01)
plot(tt,type="l")
plot(tt^2,type="l")
plot(tt^3-3*tt^2-tt+3,ylim=c(-100,50),type="l")
plot(tt^4+2*tt^3-12*tt^2-2*tt+6,ylim=c(-100,200),type="l")
par(mfrow=c(1,4))
tt=seq(-5,5,.01)
plot(tt,type="l",ylab="",xlab="")
title("1st order")
plot(tt^2,type="l",ylab="",xlab="")
title("2nd order")
plot(tt^3-3*tt^2-tt+3,ylim=c(-100,50),type="l",ylab="",xlab="")
title("3rd order")
plot(tt^4+2*tt^3-12*tt^2-2*tt+6,ylim=c(-100,100),type="l",ylab="",xlab="")
title("4th order")
par(mfrow=c(1,4))
tt=seq(-5,5,.01)
plot(tt,type="l",ylab="",xlab="")
title("1st order")
plot(tt^2,type="l",ylab="",xlab="")
title("2nd order")
plot(tt^3-3*tt^2-tt+3,ylim=c(-100,50),type="l",ylab="",xlab="")
title("3rd order")
plot(tt^4+2*tt^3-12*tt^2-2*tt+6,ylim=c(-100,100),type="l",ylab="",xlab="")
title("4th order")
par(mfrow=c(1,4))
tt=seq(-5,5,.01)
plot(tt,type="l",ylab="",xlab="")
title("1st order")
plot(tt^2,type="l",ylab="",xlab="")
title("2nd order")
plot(tt^3-3*tt^2-tt+3,ylim=c(-100,50),type="l",ylab="",xlab="")
title("3rd order")
plot(tt^4+2*tt^3-12*tt^2-2*tt+6,ylim=c(-100,100),type="l",ylab="",xlab="")
title("4th order")
landings$t = landings$Year-1963
model <- lm(log.metric.tons ~ poly(t,4),
data=landings, subset=Species=="Anchovy")
summary(model)
landings$t = landings$Year-1963
model <- lm(log.metric.tons ~ t+I(t^2)+I(t^3)+I(t^4),
data=landings, subset=Species=="Anchovy")
summary(model)
landings$t = landings$Year-1963
model <- lm(log.metric.tons ~ I(t)+I(t^2)+I(t^3)+I(t^4),
data=landings, subset=Species=="Anchovy"&year<=1987)
landings$t = landings$Year-1963
model <- lm(log.metric.tons ~ I(t)+I(t^2)+I(t^3)+I(t^4),
data=landings, subset=Species=="Anchovy"&Year<=1987)
summary(model)
model
model.matrix(model)
landings$t = landings$Year-1963
model <- lm(log.metric.tons ~ poly(t,4),
data=landings, subset=Species=="Anchovy"&Year<=1987)
summary(model)
options(htmltools.dir.version = FALSE, servr.daemon = TRUE)
library(huxtable)
load("Data/landings.RData")
landings$log.metric.tons = log(landings$metric.tons)
landings = subset(landings, Year <= 1989)
landings = subset(landings, Species %in% c("Anchovy","Sardine"))
library(ggplot2)
ggplot(landings, aes(x=Year, y=metric.tons)) +
geom_line() + facet_wrap(~Species)
load("Data/landings.RData")
landings$log.metric.tons = log(landings$metric.tons)
landings = subset(landings, Year <= 1989)
landings = subset(landings, Species %in% c("Anchovy","Sardine"))
library(ggplot2)
ggplot(landings, aes(x=Year, y=log.metric.tons)) +
geom_line() + facet_wrap(~Species)
ggplot(landings, aes(x=Year, y=log.metric.tons)) +
+   geom_line() + facet_wrap(~Species)
load("Data/landings.RData")
landings$log.metric.tons = log(landings$metric.tons)
landings = subset(landings, Year <= 1989)
landings = subset(landings, Species %in% c("Anchovy","Sardine"))
library(ggplot2)
ggplot(landings, aes(x=Year, y=log.metric.tons)) +
geom_line() + facet_wrap(~Species)
options(htmltools.dir.version = FALSE, servr.daemon = TRUE)
library(huxtable)
load("Data/landings.RData")
landings$log.metric.tons = log(landings$metric.tons)
landings = subset(landings, Year <= 1989)
anchovy = subset(landings, Species=="Anchovy")$log.metric.tons
sardine = subset(landings, Species=="Sardine")$log.metric.tons
library(ggplot2)
library(gridExtra)
library(reshape2)
library(tseries)
library(urca)
require(urca)
ur.df(anchovy, type="none", lags=0)
require(urca)
test = ur.df(anchovy, type="none", lags=0)
test
summary(test)
names(summary(test))
attr(summary(test))
names(test)
test
class(test)
attr(test,"package")
attr(test)
attributes(test)
test$cval
attr(test,"cval")
summary(test)
attributes(test)
attr(test,"cval")
attr(test,"cval")[2\
attr(test,"cval")[2]
require(tseries)
adf.test(anchovy)
adf.test(sardine)
require(urca)
test = ur.df(anchovy, type="none", lags=0)
test
test = ur.df(anchovy, type="trend", lags=0)
test
attr(test,"cval")[2]
attr(test,"cval")
test = ur.df(anchovy, type="drift", lags=0)
test
attr(test,"cval")
adf.test(anchovy)
adf.test(sardine)
plot(sardine)
plot(anchovy)
adf.test((1:24)+rnorm(24)
)
adf.test((1:24)+rnorm(24))
adf.test((1:24)+rnorm(24))
adf.test((1:24)+rnorm(24))
adf.test((1:100)+rnorm(100))
adf.test((1:100)+rnorm(100))
adf.test((1:30)+rnorm(30))
adf.test((1:30)+rnorm(30))
adf.test((1:30)+rnorm(30))
adf.test((1:30)+rnorm(30),k=0)
test=adf.test((1:30)+rnorm(30),k=0)
summary(test)
coef(test)
test
class(test)
attributes(test)
test$parameter
test$method
test=ur.df((1:30)+rnorm(30),k=2,type="trend")
test=ur.df((1:30)+rnorm(30),lags=2,type="trend")
test
attr(test,"cval")
test=ur.df((1:30)+rnorm(30),lags=2,type="drift")
test
attr(test,"cval")
test=ur.df((1:30)+rnorm(30),lags=2,type="trend")
test
aa=(1:30)+rnorm(30)
adf.test(aa)
test=ur.df(aa,lags=2,type="trend")
test
test=ur.df(aa,lags=3,type="trend")
test
require(tseries)
kpss.test(anchovy, null="Trend")
kpss.test(sardine)
require(tseries)
kpss.test(anchovy, null="Trend")
kpss.test(sardine, null="Trend")
?kpss.test
diff(anchovy)
diff(anchovy)
p1 = ggplot(anchovy, aes(x=Year,y=log.metric.tons)) +
geom_line() + xlab("") + ylab("value") +
ggtitle("anchovy")
p1 = ggplot(anchovy, aes(x=Year,y=log.metric.tons)) +
geom_line() + xlab("") + ylab("value") +
ggtitle("anchovy")
anchovy
ggplot(landings, aes(x=Year,y=log.metric.tons, group="Anchovy")) +
geom_line() + xlab("") + ylab("value") +
ggtitle("anchovy")
landings
?ggplot
ggplot(landings, aes(x=Year, y=log.metric.tons))
landings
ggplot(landings, aes(x=Year, y=log.metric.tons)) +
geom_line()
ggplot(subset(landings, Species=="Anchovy"), aes(x=Year,y=log.metric.tons)) +
geom_line() + xlab("") + ylab("value") +
ggtitle("anchovy")
par(mfrow=c(1,2))
plot(anchovy)
plot(diff(anchovy))
par(mfrow=c(1,2))
plot(anchovy)
plot(diff(anchovy))
par(mfrow=c(1,2))
plot(anchovy, type="l")
plot(diff(anchovy), type="l")
adf.test(diff(anchovy))
adf.test(diff(anchovy),k=0)
adf.test(diff(anchovy),k=2)
ndiffs(anchovy)
library(forecast)
ndiffs(anchovy)
?ndiffs
ndiffs(anchovy, test="adf")
anchovy
adf.test(diff(anchovy))
?adf.test
adf.test(diff(anchovy),k=1)
ndiffs
?ur.df
?ur.kpss
ur.kpss(rnorm(100))
ur.kpss(rnorm(100)+1:100)
test=ur.kpss(rnorm(100)+1:100)
summary(test)
test=ur.kpss(rnorm(100))
summary(test)
test=ur.kpss(rnorm(100)+1:100, type="tau")
summary(test)
test=ur.kpss(rnorm(100)+1:100, type="tau")
summary(test)
test=ur.kpss(rnorm(100)+1:100)
summary(test)
test=ur.kpss(rnorm(100)+100)
summary(test)
?kpss.test
diff.anchovy = diff(anchovy)
diff.sardine = diff(sardine)
kpss.test(diff.anchovy)
?adf.test
diff.anchovy = diff(anchovy)
diff.sardine = diff(sardine)
kpss.test(diff.anchovy)
adf.test(diff.anchovy, k=1)
diff.anchovy = diff(anchovy)
diff.sardine = diff(sardine)
kpss.test(diff.anchovy)
adf.test(diff.anchovy, k=2)
diff.anchovy = diff(anchovy)
diff.sardine = diff(sardine)
kpss.test(diff.anchovy)
kpass.test(diff.sardine)
diff.anchovy = diff(anchovy)
diff.sardine = diff(sardine)
kpss.test(diff.anchovy)
kpss.test(diff.sardine)
?adf.test
adf.test(diff.anchovy)
adf.test(diff.sardine)
ur.df(diff.anchovy)
ur.df(diff.sardine)
summary(ur.df(diff.anchovy))

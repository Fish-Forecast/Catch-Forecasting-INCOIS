<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap/shim/respond.min.js"></script>
<script src="site_libs/navigation/tabsets.js"></script>
<link href="site_libs/highlightjs/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs/highlight.js"></script>
<link href="site_libs/font-awesome/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome/js/fa-v4-shims.min.js"></script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">fish forecast</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="setup.html">Set-up</a>
</li>
<li>
  <a href="Forecasting_1_-_Introduction.html">Introduction</a>
</li>
<li>
  <a href="TV-Regression.html">TV Regresson</a>
</li>
<li>
  <a href="ARMA-Models.html">ARMA Models</a>
</li>
<li>
  <a href="Exp_Smoothing.html">Exp Smoothing</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://rverse-tutorials.github.io/Fish-Forecast-Training-Course/">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://rverse-tutorials.github.io/RWorkflow-Workshop">
    <span class="fa fa-wrench"></span>
     
  </a>
</li>
<li>
  <a href="https://fish-forecast.github.io/Catch-Forecasting-INCOIS/">
    <span class="fa fa-line-chart"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/Fish-Forecast/Catch-Forecasting-INCOIS">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<p>layout: true</p>
<p>.hheader[<a href="index.html"><svg style="height:0.8em;top:.04em;position:relative;fill:steelblue;" viewBox="0 0 576 512"><path d="M488 312.7V456c0 13.3-10.7 24-24 24H348c-6.6 0-12-5.4-12-12V356c0-6.6-5.4-12-12-12h-72c-6.6 0-12 5.4-12 12v112c0 6.6-5.4 12-12 12H112c-13.3 0-24-10.7-24-24V312.7c0-3.6 1.6-7 4.4-9.3l188-154.8c4.4-3.6 10.8-3.6 15.3 0l188 154.8c2.7 2.3 4.3 5.7 4.3 9.3zm83.6-60.9L488 182.9V44.4c0-6.6-5.4-12-12-12h-56c-6.6 0-12 5.4-12 12V117l-89.5-73.7c-17.7-14.6-43.3-14.6-61 0L4.4 251.8c-5.1 4.2-5.8 11.8-1.6 16.9l25.5 31c4.2 5.1 11.8 5.8 16.9 1.6l235.2-193.7c4.4-3.6 10.8-3.6 15.3 0l235.2 193.7c5.1 4.2 12.7 3.5 16.9-1.6l25.5-31c4.2-5.2 3.4-12.7-1.7-16.9z"/></svg></a>]</p>
<hr />
<p>class: center, middle, inverse # Forecasting Time Series ## Seasonal Exponential Smoothing Models</p>
<p>.futnote[Eli Holmes, NOAA Fisheries]</p>
<p>.citation[<a href="mailto:eli.holmes@noaa.gov">eli.holmes@noaa.gov</a>]</p>
<hr />
<p>To make your introduction to time-series modeling in R a little gentler, I started with non-seasonal models.</p>
<p>To work with seasonal data, we need to turn our data into a ts object, which is a “time-series” object in R. This will allow us to specify the seasonality. It is important that we do not leave out any data in our time series. You data should look like so</p>
<pre><code>  Year   Month  metric.tons
 2018   1           1
 2018   2           2
 2018   3           3
 ...   
 2019   1           4
 2019   2           6
 2019   3          NA</code></pre>
<p>The months are in order and the years are in order.</p>
<hr />
<div id="load-the-chinook-salmon-data-set" class="section level2">
<h2>Load the chinook salmon data set</h2>
<pre class="r"><code>load(&quot;chinook.RData&quot;)
head(chinook)</code></pre>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 38.8888888888889%; margin-left: 0%;">
<col style="width: NA;"><col style="width: NA;"><col style="width: NA;"><col style="width: NA;"><col style="width: NA;"><tr>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0.4pt 0pt 0.4pt 0.4pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; "><span style="font-weight: bold; ">Year</span></td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0.4pt 0pt 0.4pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; "><span style="font-weight: bold; ">Month</span></td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0.4pt 0pt 0.4pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; "><span style="font-weight: bold; ">Species</span></td>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0.4pt 0pt 0.4pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; "><span style="font-weight: bold; ">log.metric.tons</span></td>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0.4pt 0.4pt 0.4pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; "><span style="font-weight: bold; ">metric.tons</span></td>
</tr>
<tr>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0pt 0pt 0.4pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">1990</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">Jan</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">Chinook</td>
  <td  style="vertical-align: top; text-align: right; white-space: normal; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">3.4&nbsp;</td>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0.4pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">29.9</td>
</tr>
<tr>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0pt 0pt 0.4pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">1990</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">Feb</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">Chinook</td>
  <td  style="vertical-align: top; text-align: right; white-space: normal; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">3.81</td>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0.4pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">45.1</td>
</tr>
<tr>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0pt 0pt 0.4pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">1990</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">Mar</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">Chinook</td>
  <td  style="vertical-align: top; text-align: right; white-space: normal; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">3.51</td>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0.4pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">33.5</td>
</tr>
<tr>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0pt 0pt 0.4pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">1990</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">Apr</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">Chinook</td>
  <td  style="vertical-align: top; text-align: right; white-space: normal; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">4.25</td>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0.4pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">70&nbsp;&nbsp;</td>
</tr>
<tr>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0pt 0pt 0.4pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">1990</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">May</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">Chinook</td>
  <td  style="vertical-align: top; text-align: right; white-space: normal; border-width:0pt 0pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">5.2&nbsp;</td>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0.4pt 0pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242); ">181&nbsp;&nbsp;</td>
</tr>
<tr>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0pt 0.4pt 0.4pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">1990</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0.4pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">Jun</td>
  <td  style="vertical-align: top; text-align: left; white-space: nowrap; border-width:0pt 0pt 0.4pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">Chinook</td>
  <td  style="vertical-align: top; text-align: right; white-space: normal; border-width:0pt 0pt 0.4pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">4.37</td>
  <td  style="vertical-align: top; text-align: right; white-space: nowrap; border-width:0pt 0.4pt 0.4pt 0pt; border-style: solid; border-top-color: NA;  border-right-color: NA;  border-bottom-color: NA;  border-left-color: NA; padding: 4pt 4pt 4pt 4pt; ">79.2</td>
</tr>
</table>

<hr />
<p>The data are monthly and start in January 1990. To make this into a ts object do</p>
<pre class="r"><code>chinookts &lt;- ts(chinook$log.metric.tons, start=c(1990,1), frequency=12)</code></pre>
<p><code>start</code> is the year and month and frequency is the number of months in the year. If we had quarterly data that started in 2nd quarter of 1990, our call would be</p>
<pre><code>ts(chinook, start=c(1990,2), frequency=4)</code></pre>
<p>If we had daily data starting on hour 5 of day 10 and each row was an hour, our call would be</p>
<pre><code>ts(chinook, start=c(10,5), frequency=24)</code></pre>
<p>Use <code>?ts</code> to see more examples of how to set up ts objects.</p>
<hr />
</div>
<div id="plot-seasonal-data" class="section level2">
<h2>Plot seasonal data</h2>
<p>Now that we have specified our seasonal data as a ts object, it is easy to plot because R knows what the season is.</p>
<pre class="r"><code>plot(chinookts)</code></pre>
<p><img src="Forecasting_4-2_-_ETS_Seasonality_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="seasonal-exponential-smoothing-model" class="section level2">
<h2>Seasonal Exponential Smoothing Model</h2>
<p>Now we add a few more lines to our ETS table of models:</p>
<table>
<thead>
<tr class="header">
<th>model</th>
<th>“ZZZ”</th>
<th>alternate function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exponential smoothing no trend</td>
<td>“ANN”</td>
<td><code>ses()</code></td>
</tr>
<tr class="even">
<td>exponential smoothing with trend</td>
<td>“AAN”</td>
<td><code>holt()</code></td>
</tr>
<tr class="odd">
<td>exponential smoothing with season no trend</td>
<td>“ANA”</td>
<td>NA</td>
</tr>
<tr class="even">
<td>exponential smoothing with season and trend</td>
<td>“AAA”</td>
<td>NA</td>
</tr>
<tr class="odd">
<td>estimate best trend and season model</td>
<td>“ZZZ”</td>
<td>NA</td>
</tr>
</tbody>
</table>
<p>Unfortunately <code>ets()</code> will not handle missing values and will find the longest continuous piece of our data and use that.</p>
<hr />
<pre class="r"><code>library(forecast)
traindat &lt;- window(chinookts, c(1990,1), c(1999,12))
fit &lt;- ets(traindat, model=&quot;AAA&quot;)</code></pre>
<pre><code>## Warning in ets(traindat, model = &quot;AAA&quot;): Missing values encountered. Using
## longest contiguous portion of time series</code></pre>
<pre class="r"><code>fr &lt;- forecast(fit, h=24)
plot(fr)
points(window(chinookts, c(1996,1), c(1996,12)))</code></pre>
<p><img src="Forecasting_4-2_-_ETS_Seasonality_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="decompose" class="section level2">
<h2>Decompose</h2>
<p>If we plot the decomposition, we see the the seasonal component is not changing over time, unlike the actual data. The bar on the right, alerts us that the scale on the 3rd panel is much smaller.</p>
<pre class="r"><code>autoplot(fit)</code></pre>
<p><img src="Forecasting_4-2_-_ETS_Seasonality_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="force-seasonality-to-evolve-more" class="section level2">
<h2>Force seasonality to evolve more</h2>
<p>Pass in a high <code>gamma</code> (the season weighting) to force the seasonality to evolve.</p>
<pre class="r"><code>fit &lt;- ets(traindat, model=&quot;AAA&quot;, gamma=0.4)</code></pre>
<pre><code>## Warning in ets(traindat, model = &quot;AAA&quot;, gamma = 0.4): Missing values
## encountered. Using longest contiguous portion of time series</code></pre>
<pre class="r"><code>autoplot(fit)</code></pre>
<p><img src="Forecasting_4-2_-_ETS_Seasonality_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="compare-to-a-seasonal-arima-model" class="section level2">
<h2>Compare to a seasonal ARIMA model</h2>
<p><code>auto.arima()</code> will recognize that our data has season and fit a seasonal ARIMA model to our data. Let’s use the data that <code>ets()</code> used. This is shorter than our training data. The data used by <code>ets()</code> is returned in <code>fit$x</code>.</p>
<hr />
<pre class="r"><code>no_miss_dat &lt;- fit$x
fit &lt;- auto.arima(no_miss_dat)
fr &lt;- forecast(fit, h=12)
plot(fr)
points(window(chinookts, c(1996,1), c(1996,12)))</code></pre>
<p><img src="Forecasting_4-2_-_ETS_Seasonality_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="missing-values-are-ok-when-fitting-a-seasonal-arima-model" class="section level2">
<h2>Missing values are ok when fitting a seasonal ARIMA model</h2>
<pre class="r"><code>fit &lt;- auto.arima(traindat)
fr &lt;- forecast(fit, h=12)
plot(fr)</code></pre>
<p><img src="Forecasting_4-2_-_ETS_Seasonality_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="forecast-evaluation" class="section level2">
<h2>Forecast evaluation</h2>
<p>We can compute the forecast performance metrics as usual.</p>
<pre class="r"><code>fit &lt;- ets(traindat, model=&quot;AAA&quot;, gamma=0.4)</code></pre>
<pre><code>## Warning in ets(traindat, model = &quot;AAA&quot;, gamma = 0.4): Missing values
## encountered. Using longest contiguous portion of time series</code></pre>
<pre class="r"><code>fr &lt;- forecast(fit, h=12)</code></pre>
<p>Look at the forecast so you know what years and months to include in your test data. Pull those 12 months out of your data using the <code>window()</code> function.</p>
<pre class="r"><code>testdat &lt;- window(traindat, c(1996,1), c(1996,12))</code></pre>
<p>Use <code>accuracy()</code> to get the forecast error metrics.</p>
<pre class="r"><code>accuracy(fr, testdat)</code></pre>
<pre><code>##                       ME      RMSE       MAE        MPE      MAPE
## Training set  0.01190635 0.6193794 0.4787154  -5.578132  30.03221
## Test set     -0.08549288 0.5549696 0.4466604 106.497418 120.76501
##                   MASE         ACF1 Theil&#39;s U
## Training set 0.7939463  0.003452392        NA
## Test set     0.7407832 -0.015140843 0.2057023</code></pre>
<hr />
<p>We can do the same for the ARIMA model.</p>
<pre class="r"><code>no_miss_dat &lt;- fit$x
fit &lt;- auto.arima(no_miss_dat)
fr &lt;- forecast(fit, h=12)
accuracy(fr, testdat)</code></pre>
<pre><code>##                       ME      RMSE       MAE        MPE     MAPE      MASE
## Training set 0.009978349 0.5677654 0.3965957  0.4645938 27.40972 0.6577514
## Test set     0.819203922 0.9458144 0.8192039 22.0202435 55.91631 1.3586442
##                     ACF1 Theil&#39;s U
## Training set -0.06137474        NA
## Test set     -0.02804232 0.6046341</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
